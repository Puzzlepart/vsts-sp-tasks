{
    "id": "1dd6a5d1-814c-4425-a986-9bbb9b5697b8",
    "name": "RPDeployArtifactWithPnP",
    "friendlyName": "Deploy SharePoint Artifacts",
    "description": "Deploys SharePoint artifacts with the PnP provisioning engine. This is only a preview",
    "author": "Sebastian Sch√ºtze, RazorSPoint",
    "helpMarkDown": "",
    "category": "Deploy",
    "visibility": [
        "Release"
    ],
    "demands": [],
    "version": {
        "Major": "0",
        "Minor": "1",
        "Patch": "0"
    },
    "minimumAgentVersion": "1.95.0",
    "groups": [{
        "name": "advanced",
        "displayName": "Advanced",
        "isExpanded": false
    }],
    "instanceNameFormat": "Deploy SharePoint Artifacts $(message)",
    "inputs": [{
            "name": "SharePointVersion",
            "type": "radio",
            "label": "SharePoint Version",
            "defaultValue": "",
            "required": true,
            "helpMarkDown": "Version to witch the PnP xml should be deployed to.",
            "options": {
                "SpOnline": "SharePoint Online",
                "Sp2016": "SharePoint 2016"
            }
        },
        {
            "name": "FileOrInline",
            "type": "pickList",
            "label": "Type",
            "defaultValue": "File",
            "required": true,
            "helpMarkDown": "Type of the script: File Path or Inline Xml.",
            "options": {
                "File": "File Path",
                "Inline": "Inline Xml"
            }
        },
        {
            "name": "PnPXmlInline",
            "type": "multiLine",
            "label": "Inline PnP Xml",
            "defaultValue": "",
            "required": true,
            "helpMarkDown": "Allows you to specify xml containing the provisioning template. <br/><br/>Check the [existing schema](https://github.com/SharePoint/PnP-Provisioning-Schema) for a well formatted inline PnP xml.",
            "visibleRule": "FileOrInline = Inline",
            "properties": {
                "resizable": "true",
                "rows": "10"
            }
        },
        {
            "name": "PnPXmlFilePath",
            "type": "filePath",
            "label": "PnP Xml Path",
            "defaultValue": "",
            "required": true,
            "helpMarkDown": "Path to the xml or pnp file containing the provisioning template. <br/><br/>Check the [existing schema](https://github.com/SharePoint/PnP-Provisioning-Schema) for a well formatted PnP xml file.",
            "visibleRule": "FileOrInline = File"
        },
        {
            "name": "TargetWebUrl",
            "type": "string",
            "label": "Target Web Url",
            "defaultValue": "",
            "required": true,
            "helpMarkDown": "The URL to the web, where the app should be installed."
        },
        {
            "name": "Handlers",
            "type": "string",
            "label": "Handler To Be Used",
            "defaultValue": "",
            "required": false,
            "helpMarkDown": "Give a comma separated list of Handlers. Leave empty if all Handlers should be used.<br/> Allows you to only process a specific part of the template. Notice that this might fail, as some of the handlers require other artifacts in place if they are not part of what your applying. <br/><br/>Check for [available Handlers](https://msdn.microsoft.com/en-us/pnp_sites_core/officedevpnp.core.framework.provisioning.model.handlers)."
        },
        {
            "name": "Parameters",
            "type": "multiLine",
            "label": "Parameters To Be Added",
            "defaultValue": "",
            "required": false,
            "helpMarkDown": "Allows you to specify parameters that can be referred to in the template by means of the {parameter:} token. See examples on [how to use this parameter](https://github.com/SharePoint/PnP-PowerShell/blob/master/Documentation/ApplyPnPProvisioningTemplate.md#example-3).",
            "properties": {
                "resizable": "true",
                "rows": "10"
            }
        },
        {
            "name": "ClearNavigation",
            "type": "boolean",
            "label": "Clear Navigation",
            "defaultValue": "false",
            "required": false,
            "helpMarkDown": "Override the RemoveExistingNodes attribute in the Navigation elements of the template. If you specify this value the navigation nodes will always be removed before adding the nodes in the template",
            "groupName": "advanced"
        },
        {
            "name": "IgnoreDuplicateDataRowErrors",
            "type": "boolean",
            "label": "Ignore Duplicate Data Row Errors",
            "defaultValue": "false",
            "required": false,
            "helpMarkDown": "Ignore duplicate data row errors when the data row in the template already exists.",
            "groupName": "advanced"
        },
        {
            "name": "OverwriteSystemPropertyBagValues",
            "type": "boolean",
            "label": "Overwrite System Property Bag Values",
            "defaultValue": "false",
            "required": false,
            "helpMarkDown": "Specify this parameter if you want to overwrite and/or create properties that are known to be system entries (starting with vti_, dlc_, etc.)",
            "groupName": "advanced"
        },
        {
            "name": "ProvisionContentTypesToSubWebs",
            "type": "boolean",
            "label": "Provision Content Types To Sub Webs",
            "defaultValue": "false",
            "required": false,
            "helpMarkDown": "If set content types will be provisioned if the target web is a subweb.",
            "groupName": "advanced"
        }
    ],
    "execution": {
        "PowerShell3": {
            "target": "StartDeploy.ps1"
        }
    }
}